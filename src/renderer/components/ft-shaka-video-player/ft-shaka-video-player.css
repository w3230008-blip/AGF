/* stylelint-disable liberty/use-logical-spec */
.ftVideoPlayer {
  display: flex;
  position: relative;

  /*
    For vertical videos and full window mode the background is visible,
    so we want to make it black as it defaults to transparent
   */
  background-color: #000;

  /*
    Fixes the seek bar thumbnails causing a horizontal scroll bar
    to appear after exiting full screen and full window.
    But also vertically in case context menu overflows.
  */
  overflow: hidden;
}

.player {
  width: 100%;
}

/* Custom progress bar positioning */
.ftVideoPlayer :deep(.ft-custom-progress-bar-container) {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 10000;
  pointer-events: auto;
}

.vrCanvas {
  position: absolute;
  inset: 0;
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

:deep(.shaka-bottom-controls) {
  /*
    Force left to right, so that the UI doesn't break.
    With rtl, the progress bar was filling from the left, but the scrubber was moving from the right.
    video.js forced the direction for their controls too
  */
  direction: ltr;
}

.sixteenByNine {
  aspect-ratio: 16 / 9;
}

.stats {
  position: absolute;
  left: 5px;
  top: 5px;
  padding: 10px;
  border-radius: 5px;
  line-height: 1.4em;
  background-color: rgb(0 0 0 / 70%);
  color: #fff;
  z-index: 2;

  /* user-select is intentionally not disabled, so that you can select and copy the stats */
}

.valueChangePopup {
  position: absolute;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 10px;
  border-radius: 5px;
  font-size: 1.1em;
  background-color: rgb(0 0 0 / 70%);
  color: #fff;
  width: 85px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  z-index: 2;
  pointer-events: none;
}

.valueChangePopup.invert-content-order {
  flex-direction: row-reverse;
}

.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.5s ease;
}

.fade-enter-from,
.fade-leave-to {
  opacity: 0;
}

.offlineWrapper {
  position: absolute;
  top: 20px;
  inset-inline-end: 20px;
  margin-inline-start: 20px;
  display: flex;
  flex-direction: row;
  gap: 10px;
  align-items: center;
  background-color: #000;
  color: #fff;
  padding: 10px;
  border-radius: 10px;
}

.offlineIcon {
  font-size: 30px;
}

.offlineMessage {
  margin: 0;
}

.offlineMessageSubtitle {
  font-size: 0.8em;
}

.skippedSegmentsWrapper {
  position: absolute;
  right: 2%;
  bottom: max(15%, calc(46px + 2.5% + 3%)); /* 46px + 2.5% is the height of the controls */
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
  pointer-events: none;
}

.skippedSegment {
  margin-block: 0;
  padding: 10px;
  border-radius: 20px;
  background-color: rgb(0 0 0 / 80%);
  color: #fff;
}

:deep(.markerContainer) {
  position: absolute;
  inset: 0;
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
}

:deep(.sponsorBlockMarker) {
  background-color: var(--primary-color);
}

:deep(.chapterMarker) {
  width: 2px;
  background-color: #000;
}

:deep(.sponsorBlockMarker),
:deep(.chapterMarker) {
  position: absolute;
  opacity: 0.6;
  height: 100%;
}

:deep(.playerFullscreenTitleOverlay) {
  display: none;
  opacity: 0;
  position: absolute;
  margin: 0;
  top: 5px;
  left: 5px;
  max-width: calc(100% - 10px);
  font-size: xx-large;
  color: #fff;
  font-weight: normal;
  background-color: rgb(0 0 0 / 50%);
  border-radius: 5px;
  user-select: none;
  text-overflow: ellipsis;
  text-wrap: nowrap;
  overflow: hidden;

  /* copied from .shaka-scrim-container */
  transition: opacity cubic-bezier(0.4, 0, 0.6, 1) 0.6s;
}

:global(body[dir='rtl'] .playerFullscreenTitleOverlay) {
  left: initial;
  right: 5px;
}

.ftVideoPlayer:fullscreen :deep(.playerFullscreenTitleOverlay) {
  display: block;
}

:deep(.shaka-controls-container[shown='true'] > .playerFullscreenTitleOverlay) {
  opacity: 1;
}

:deep(.shaka-controls-container > .shaka-play-button-container > .shaka-play-button) {
  padding: min(calc(15% / 2), 55px);
}

.ftVideoPlayer:fullscreen :deep(.theatre-button),
.ftVideoPlayer:fullscreen :deep(.full-window-button),
.fullWindow :deep(.theatre-button) {
  display: none;
}

.fullWindow {
  position: absolute !important;
  max-width: initial !important;
  inset: 0;
  z-index: 1000;
}

.fullWindow > .player {
  width: 100%;
  height: 100%;
}

/* added to the body element */
:global(.playerFullWindow) {
  overflow: hidden;
  margin: 0;
  padding: 0;
}

/* Caption customization styles */
:deep(.shaka-text-container) {
  /* Ensure captions are above all player elements */
  z-index: 9999 !important;
  position: absolute !important;

  /* Allow clicks to pass through to controls */
  pointer-events: none !important;

  /* Smooth transition when lifting captions */
  transition: bottom 0.2s ease-out !important;
}

:deep(.shaka-text-container > div) {
  /* Full-width background for subtitle lines */
  width: 100% !important;
  background-color: var(--caption-bg-color, rgb(0 0 0 / 80%)) !important;
  text-align: center !important;
  padding-block: 2px !important;
  box-sizing: border-box !important;
}

:deep(.shaka-text-container span) {
  font-size: var(--caption-font-size, 24px) !important;
  color: var(--caption-font-color, #fff) !important;
  font-family: var(--caption-font-family, Arial) !important;

  /* Remove background from spans as it's now on the parent div */
  background-color: transparent !important;
}

/* Ensure caption text can still be selected if needed */
:deep(.shaka-text-container *) {
  pointer-events: auto !important;
}

@media only screen and (width <=400px) {
  :deep(.shaka-text-container) {
    /* make subtitles take up slightly less space when a mobile phone is in portrait orientation */
    font-size: 16px !important;
  }

  :deep(.shaka-text-container span) {
    font-size: var(--caption-font-size, 16px) !important;
  }
}

@media only screen and (width <=1000px) {
  :deep(.playerFullscreenTitleOverlay) {
    font-size: large;
  }
}

@media only screen and (width <=1350px) {
  :deep(.theatre-button) {
    display: none;
  }
}

@media (prefers-reduced-transparency) {
  :deep(.playerFullscreenTitleOverlay),
  .skippedSegment,
  .stats {
    background-color: rgb(0 0 0 / 90%);
  }
}

/* Single-line caption mode - instantly hide top lines without JS delay */
:deep(.shaka-text-container.ft-single-line-captions > div:not(:last-child)) {
  display: none !important;
  opacity: 0 !important;
  visibility: hidden !important;
}

:deep(.shaka-text-container.ft-single-line-captions span:not(:last-of-type)) {
  display: none !important;
}

:deep(.shaka-text-container.ft-single-line-captions br) {
  display: none !important;
}

/* Playback speed buttons */
:deep(.playback-speed-buttons-container) {
  display: flex;
  gap: 4px;
  align-items: center;
  margin-inline: 12px;
  position: relative;
  z-index: 1;
  pointer-events: auto;
}

:deep(.playback-speed-button) {
  min-width: 40px;
  height: 32px;
  padding: 4px 8px;
  background-color: transparent;
  color: #fff;
  border: 1px solid rgb(255 255 255 / 30%);
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  user-select: none;
  position: relative;
  pointer-events: auto;
}

:deep(.playback-speed-button:hover) {
  background-color: rgb(255 255 255 / 20%);
  border-color: rgb(255 255 255 / 50%);
}

:deep(.playback-speed-button.active) {
  background-color: var(--primary-color);
  border-color: var(--primary-color);
  font-weight: 700;
}

:deep(.playback-speed-button:focus) {
  outline: 2px solid var(--primary-color);
  outline-offset: 2px;
}

/* Frame navigation buttons */
:deep(.frame-navigation-buttons-container) {
  display: flex;
  gap: 4px;
  align-items: center;


  /* stylelint-disable declaration-block-no-redundant-longhand-properties */
  margin-inline-start: 4px;
  margin-inline-end: 12px;

  /* stylelint-enable declaration-block-no-redundant-longhand-properties */
  position: relative;
  z-index: 1;
  pointer-events: auto;
}

:deep(.frame-navigation-button) {
  min-width: 40px;
  height: 32px;
  padding: 4px 8px;
  background-color: transparent;
  color: #fff;
  border: 1px solid rgb(255 255 255 / 30%);
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  user-select: none;
  position: relative;
  pointer-events: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: -7px;
}

:deep(.frame-navigation-button:hover) {
  background-color: rgb(255 255 255 / 20%);
  border-color: rgb(255 255 255 / 50%);
}

:deep(.frame-navigation-button:focus) {
  outline: 2px solid var(--primary-color);
  outline-offset: 2px;
}

/* Chapter navigation buttons */
:deep(.chapter-navigation-buttons-container) {
  display: flex;
  gap: 4px;
  align-items: center;
  margin-left: 75px !important;

  /* stylelint-disable declaration-block-no-redundant-longhand-properties */
  margin-inline-start: 12px;
  margin-inline-end: 4px;

  /* stylelint-enable declaration-block-no-redundant-longhand-properties */
  position: relative;
  z-index: 1;
  pointer-events: auto;
}

:deep(.chapter-navigation-button) {
  min-width: 40px;
  height: 32px;
  padding: 4px 8px;
  background-color: transparent;
  color: #fff;
  border: 1px solid rgb(255 255 255 / 30%);
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  user-select: none;
  position: relative;
  pointer-events: auto;
  display: flex;
  align-items: center;
  justify-content: center;
}

:deep(.chapter-navigation-button:hover) {
  background-color: rgb(255 255 255 / 20%);
  border-color: rgb(255 255 255 / 50%);
}

:deep(.chapter-navigation-button:focus) {
  outline: 2px solid var(--primary-color);
  outline-offset: 2px;
}

/* Custom subtitle button (LS) */
:deep(.custom-subtitle-button) {
  margin-inline: 4px;
  min-inline-size: 40px;
}

:deep(.custom-subtitle-label) {
  font-weight: bold;
  font-size: 14px;
}

:deep(.custom-subtitle-menu) {
  min-inline-size: 200px;
}

:deep(.custom-subtitle-upload-button),
:deep(.custom-subtitle-settings-button) {
  padding-block: 8px;
  padding-inline: 12px;
  inline-size: 100%;
  text-align: start;
}

:deep(.custom-subtitle-upload-button:hover),
:deep(.custom-subtitle-settings-button:hover) {
  background-color: rgb(255 255 255 / 10%);
}

/* Floating window overlay */
:deep(.floatingWindow) {
  z-index: 10002;
}

/* Custom subtitle display */
:deep(.customSubtitleDisplay) {
  z-index: 10001;
}

/* Custom subtitle button icon styling */
.ft-custom-subtitle-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 700;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  width: 24px;
  height: 24px;
  border: 1.5px solid currentcolor;
  border-radius: 3px;
  background: transparent;
  line-height: 1;
  letter-spacing: -0.5px;
}

/* stylelint-enable liberty/use-logical-spec */

/* Keep volume slider visible and accessible */
.ftVideoPlayer :deep(.shaka-volume-bar-container) {
  opacity: 1 !important;
  visibility: visible !important;
  transition: none !important;
  flex-shrink: 0 !important;
  min-inline-size: 100px !important;
}

.ftVideoPlayer :deep(.shaka-volume-bar) {
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
}

/* Prevent time display from overlapping volume slider */
.ftVideoPlayer :deep(.shaka-current-time) {
  max-inline-size: 120px !important;
  min-inline-size: 80px !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
  margin-inline-end: 8px !important;
  flex-shrink: 0 !important;
}

.ftVideoPlayer :deep(.shaka-time-and-duration) {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important;
  margin-inline-end: 8px !important;
  flex-shrink: 0 !important;
}

.ftVideoPlayer :deep(.shaka-duration) {
  max-inline-size: 80px !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
  flex-shrink: 0 !important;
}

/* Audio Track Language Code Badge Styling */
:deep(.audio-track-language-code) {
  display: inline-block;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 4px 6px;
  background: rgb(255 255 255 / 15%);
  border-radius: 3px;
  min-width: 24px;
  text-align: center;
  line-height: 1;
  transition: background-color 0.2s ease;
}

:deep(.audio-track-button:hover .audio-track-language-code) {
  background: rgb(255 255 255 / 25%);
}

/* Ensure the button has proper spacing */
:deep(.audio-track-button) {
  margin: 0 2px;
}

/* Audio Track Button */
:deep(.audio-track-button-container) {
  display: flex;
  position: relative;
  margin: 0 2px;
}

:deep(.audio-track-button) {
  min-width: 40px;
  height: 32px;
  padding: 4px 8px;
  background-color: transparent;
  color: #fff;
  border: 1px solid rgb(255 255 255 / 30%);
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  user-select: none;
  position: relative;
  pointer-events: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
}

:deep(.audio-track-button:hover) {
  background-color: rgb(255 255 255 / 20%);
  border-color: rgb(255 255 255 / 50%);
}

:deep(.audio-track-button:focus) {
  outline: 2px solid var(--primary-color);
  outline-offset: 2px;
}

:deep(.audio-track-icon) {
  font-size: 14px;
  line-height: 1;
}

:deep(.audio-track-language-code) {
  font-size: 12px;
  font-weight: 600;
  line-height: 1;
  min-width: 20px;
  text-align: center;
}

/* Audio Track Dropdown */
:deep(.audio-track-dropdown) {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background-color: rgb(0 0 0 / 90%);
  border: 1px solid rgb(255 255 255 / 30%);
  border-radius: 4px;
  padding: 4px 0;
  margin-bottom: 4px;
  min-width: 180px;
  max-height: 200px;
  overflow-y: auto;
  z-index: 1000;
  box-shadow: 0 4px 12px rgb(0 0 0 / 50%);
}

:deep(.audio-track-option) {
  width: 100%;
  padding: 8px 12px;
  background-color: transparent;
  color: #fff;
  border: none;
  text-align: left;
  font-size: 14px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  transition: background-color 0.2s ease;
}

:deep(.audio-track-option:hover) {
  background-color: rgb(255 255 255 / 10%);
}

:deep(.audio-track-option.audio-track-active) {
  background-color: rgb(255 255 255 / 20%);
  font-weight: 500;
}

:deep(.audio-track-name) {
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

:deep(.audio-track-original) {
  color: rgb(255 255 255 / 70%);
  font-size: 12px;
}

:deep(.audio-track-checkmark) {
  color: var(--primary-color, #0080ff);
  font-weight: bold;
  flex-shrink: 0;
}

/* Hide the default icon since we're using language code */
:deep(.audio-track-button .material-icons-round) {
  display: none;
}

